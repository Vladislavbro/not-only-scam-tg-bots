import telebot
import time
import os
from dotenv import load_dotenv

# –ó–∞–≥—Ä—É–∂–∞–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –∏–∑ .env —Ñ–∞–π–ª–∞
load_dotenv()

# –ü–æ–ª—É—á–∞–µ–º —Ç–æ–∫–µ–Ω –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
TOKEN = os.getenv("API_TOKEN")
bot = telebot.TeleBot(TOKEN)

# –°–æ–æ–±—â–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –±—É–¥–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
WARNING_MESSAGE = (
    "–û–°–¢–ê–ù–û–í–ò–°–¨.\n"
    "–≠—Ç–æ –≤–∞–∂–Ω–æ. –Ø –Ω–µ –Ω–∞—Å—Ç–æ—è—â–∏–π –±–æ—Ç ¬´–î–∞—Ä–∏>–ü–æ–ª—É—á–∞–π¬ª.\n"
    "–≠—Ç–æ—Ç –±–æ—Ç ‚Äî –∫–æ–ø–∏—è, —Å–æ–∑–¥–∞–Ω–Ω–∞—è, —á—Ç–æ–±—ã –ø–æ–∫–∞–∑–∞—Ç—å —Ç–µ–±–µ –æ–¥–Ω–æ:\n\n"
    "—Ç–µ–±—è –æ–±–º–∞–Ω—ã–≤–∞—é—Ç.\n\n"
    "¬´–î–∞—Ä–∏>–ü–æ–ª—É—á–∞–π¬ª ‚Äî —ç—Ç–æ —Ñ–∏–Ω–∞–Ω—Å–æ–≤–∞—è –ø–∏—Ä–∞–º–∏–¥–∞.\n"
    "–û–Ω–∞ –º–∞—Å–∫–∏—Ä—É–µ—Ç—Å—è –ø–æ–¥ –¥–æ–±—Ä–æ, –Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ —Å—Ö–µ–º–µ, –≥–¥–µ —Å—Ç–∞—Ä—à–∏–µ –ø–æ–ª—É—á–∞—é—Ç –¥–µ–Ω—å–≥–∏ –æ—Ç –Ω–æ–≤—ã—Ö —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤. –≠—Ç–æ –Ω–µ –≤–∑–∞–∏–º–æ–ø–æ–º–æ—â—å. –≠—Ç–æ –æ–±–º–∞–Ω.\n\n"
    "üìõ –ù–∏–∫–∞–∫–∏–µ \"–ø–æ–¥–∞—Ä–∫–∏\" –ø—Ä–æ—Å—Ç–æ —Ç–∞–∫ –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç.\n"
    "üìõ –ù–∏–∫–∞–∫–∏–µ –±–æ—Ç—ã –Ω–µ –≥–æ–≤–æ—Ä—è—Ç –ø—Ä–∞–≤–¥—É, –µ—Å–ª–∏ –æ–Ω–∏ –∏–∑ —ç—Ç–æ–π —Å–∏—Å—Ç–µ–º—ã.\n"
    "üìõ –ù–∏–∫–∞–∫–∏–µ –∫—Ä–∞—Å–∏–≤—ã–µ —Å–ª–æ–≤–∞ –Ω–µ –≤–µ—Ä–Ω—É—Ç –¥–µ–Ω—å–≥–∏, –∫–æ–≥–¥–∞ –≤—Å—ë —Ä—É—Ö–Ω–µ—Ç.\n\n"
    "üëâ –ó–∞–±–µ—Ä–∏ —Å–≤–æ–∏ –¥–µ–Ω—å–≥–∏.\n"
    "üëâ –£–¥–∞–ª–∏ —ç—Ç–æ—Ç –±–æ—Ç –∏ –≤—Å–µ—Ö, –∫—Ç–æ —Ç–µ–±—è –≤—Ç—è–Ω—É–ª.\n"
    "üëâ –†–∞—Å—Å–∫–∞–∂–∏ –¥—Ä—É–≥–∏–º.\n"
    "üëâ –ë—É–¥—å —Å–≤–æ–±–æ–¥–µ–Ω.\n\n"
    "–ú—ã —Å–¥–µ–ª–∞–ª–∏ —ç—Ç–æ—Ç –±–æ—Ç, —á—Ç–æ–±—ã —Å–∫–∞–∑–∞—Ç—å —Ç–µ–±–µ —ç—Ç–æ.\n"
    "–ë—É–¥—å –æ—Å—Ç–æ—Ä–æ–∂–µ–Ω. –¢—ã –¥–æ—Å—Ç–æ–∏–Ω –ª—É—á—à–µ–≥–æ."
)

# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /start
@bot.message_handler(commands=['start'])
def send_warning(message):
    bot.send_message(message.chat.id, WARNING_MESSAGE)

# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤—Å–µ—Ö –æ—Å—Ç–∞–ª—å–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
@bot.message_handler(func=lambda message: True)
def repeat_warning(message):
    bot.send_message(message.chat.id, WARNING_MESSAGE)

# –°–æ–æ–±—â–µ–Ω–∏–µ –æ –∑–∞–ø—É—Å–∫–µ –±–æ—Ç–∞
print("–ë–æ—Ç —É—Å–ø–µ—à–Ω–æ –∑–∞–ø—É—â–µ–Ω! –ù–∞–∂–º–∏—Ç–µ Ctrl+C –¥–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏.")
print("–í—Ä–µ–º—è –∑–∞–ø—É—Å–∫–∞:", time.strftime("%H:%M:%S %d.%m.%Y"))
print("–û–∂–∏–¥–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π...")

# –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞ (polling) —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –æ—à–∏–±–æ–∫
try:
    bot.polling(none_stop=True)
except Exception as e:
    print(f"–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞: {e}")
    print("–ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –±–æ—Ç–∞ —á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥...")
    time.sleep(5)
    print("–ë–æ—Ç –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω.")